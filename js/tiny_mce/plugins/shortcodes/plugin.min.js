tinymce.PluginManager.add("shortcodes", function(e, template) {   
    function o() {
	var elm = document.querySelector('.email-collapse.panel-collapse.collapse.in')
        var active = elm.id
        var parent = elm.parentNode.parentNode.id+'-'
        var template = active.replace(parent,'')

	//var template = document.getElementById('mce_49').parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.firstChild.id;
        e.windowManager.open( {
            
            url: '/shortcode.php',
            buttons: [
              {
                text: 'Close',
                subtype: 'primary',
                onclick: 'close'
               }
            ],
            width: 520,
            height: 440
          }, {
            template: template
        }
        )
    }
    e.addCommand("mceCodeEditor", o), e.addButton("shortcodes", {
       icon: "help", tooltip: "Short Codes", onclick: o
    }
    ), e.addMenuItem("code", {
        icon: "help", text: "Short Codes", context: "tools", onclick: o
    }
    )
}
);
